!function(n,a,e){function t(t){function s(n){var e,t=n.children(),r=t.length;for(e=0;r>e;e++){var g=a(t[e]),h=g.children(":first"),f=g.children("ul");f.length&&(o(g,i),h.after(u),!d.expand&&f.hide(),o(g,d.expand&&c||l),s(f))}}function h(n,a){var t=e.isUndefined(a)?n.hasClass(l):a,r=n.children("ul");r.length&&n.removeClass(t&&l||c),r.length&&o(n,t&&c||l),t&&r.slideDown()||r.slideUp()}function f(n){for(var e=n.parents("li"),t=e.length,r=0;t>r;)h(a(e[r++]),!0)}function p(n){return a('[href="'+n+'"]')}var d=a.extend({},g,t);return function(){var e,t=r.hash,i=this,l=i.$navigator,c=l.children(d.selector),u=c.length;for(o(c,"navigator-collapses"),e=0;u>e;e++)s(a(c[e]));i.$navigatorWrap.on("click",".navigator-collapse__toggle",function(n){var e=a(n.currentTarget),r=e.attr("href");r&&t!==r||(h(a(n.currentTarget).parent()),n.stopPropagation())}),i.$container.on("turnPrev",function(){h(c.find(".navigator-collapse > .selected").parent(),!0)}),i.$container.on("turnNext",function(){h(c.find(".navigator-collapse > .selected").parent(),!0)}),a(n).on("hashchange",function(){t=r.hash,f(p(t))}),f(p(t))}}var r=n.location,o=e.addClassName,i="navigator-collapse",l=i+"--close",c=i+"--open",s=i+"__toggle",u='<span class="'+s+'"></span>',g={selector:"ul",expand:!0};e.potion.collapseNavigator=function(n){var a=this,e=t(n);a.config.navigatorCallbackQueue.push({success:e})}}(window,jQuery,Magicbook);