!function(r,n,e){function t(r){function t(r,n){r.url=r.url.replace(/^('|")/,"").replace(/('|")$/,""),n()}function l(r){var n=r.url;n.match(/^(https?|ftp):\/\//g)||(r.url=this.relativeCurrentUrl(n))}function u(r){function n(){t++,a=!0}for(var e=p.length,t=0,a=!1;e>t;){var i=p[t];if(a=!1,i.call(this,r,n))break;if(!a)break}return r}function o(r){var e=r.trim().replace(/\s+/g," ").split(" "),t=e[0],i=e.length;if(1>=i||t!==a)return s+r+f;var l,o=e[1],c=u.call(this,{url:o});return n.ajax({url:c.url,async:!1,success:function(r){l=r},error:function(){l=[a,": '",o,"' not found"].join(" ")}}),l}var c=n.extend({},i,r),s=c.openTag,f=c.closeTag,p=e.parseArray(c.normalizes);return p.unshift(t),p.push(l),function(r){var n,e=(r||"").split(s),t=e.length;if(1>=t)return r;var a="";for(n=0;t>n;n++){var i=e[n],l=i.split(f);if(1!==l.length){var u=o.call(this,l[0]);a+=u,a+=l[1]}else a+=l[0]}return a}}var a="include",i={openTag:"{%",closeTag:"%}",normalizes:[]};e.potion.enableIncludeTag=function(r){var n=this,e=t(r);n.config.parseFilters.push({before:e}),n.templateIncludeTag=e}}(window,jQuery,Magicbook);