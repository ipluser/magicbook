!function(e,r){if(!e.document)throw new Error("magicbook requires a window with a document");"object"==typeof module&&"object"==typeof module.exports?module.exports=r(require("jquery"),require("magicbookjs"),e):"function"==typeof define&&define.amd?define(["jquery","magicbook"],r($,Magicbook,e)):r(e.jQuery,Magicbook,e)}("undefined"!=typeof window?window:this,function(e,r,n){function t(n){function t(e,r){e.url=e.url.replace(/^('|")/,"").replace(/('|")$/,""),r()}function u(e){var r=e.url;r.match(/^(https?|ftp):\/\//g)||(e.url=this.relativeCurrentUrl(r))}function a(e){function r(){t++,o=!0}for(var n=p.length,t=0,o=!1;n>t;){var i=p[t];if(o=!1,i.call(this,e,r))break;if(!o)break}return e}function l(r){var n=r.trim().replace(/\s+/g," ").split(" "),t=n[0],i=n.length;if(1>=i||t!==o)return f+r+s;var u,l=n[1],c=a.call(this,{url:l});return e.ajax({url:c.url,async:!1,success:function(e){u=e},error:function(){u=[o,": '",l,"' not found"].join(" ")}}),u}var c=e.extend({},i,n),f=c.openTag,s=c.closeTag,p=r.parseArray(c.normalizes);return p.unshift(t),p.push(u),function(e){var r,n=(e||"").split(f),t=n.length;if(1>=t)return e;var o="";for(r=0;t>r;r++){var i=n[r],u=i.split(s);if(1!==u.length){var a=l.call(this,u[0]);o+=a,o+=u[1]}else o+=u[0]}return o}}var o="include",i={openTag:"{%",closeTag:"%}",normalizes:[]};r.potion.enableIncludeTag=function(e){var r=this,n=t(e);r.config.parseFilters.push({before:n}),r.templateIncludeTag=n}});